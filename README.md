# Cve-Search for Docker [![](https://images.microbadger.com/badges/version/ttimasdf/cve-search:withdb.svg)](https://hub.docker.com/r/ttimasdf/cve-search "Dockerhub") [![](https://images.microbadger.com/badges/image/ttimasdf/cve-search:withdb.svg)](https://microbadger.com/images/ttimasdf/cve-search "Inspect Layers")
- This is a docker container for the CVE-Search tool.
- Port 5000 is exposed for web interface.
- The initial import of database takes over 6 hours to get going on a reasonably specced machine
- This fork of the original repo is based on an Ubuntu 18.04 LTS (Bionic) image so supports Python 3.6 which is required for CVE Search nowadays

## Usage
### Default flavour, without pre-initialized embedded DB
```sh
sudo docker build -t cve-search .
sudo docker run -d -p 5000:5000 --name cve cve-search

# The container execute the following commands by itself on boot:
sudo docker exec -it cve /bin/bash
cd /opt/cve/
./sbin/db_mgmt_cpe_dictionary.py
./sbin/db_mgmt_json.py -p
./sbin/db_updater.py -c
./sbin/db_mgmt_ref.py
```
  - The database will be downloaded when the container is first launched, this can take some time.
  - You can then run, for example `docker exec -it [CONTAINER] search.py -f nagios -n` or other scripts provided by [cve-search](https://github.com/cve-search/cve-search) to interact with the database.
  - Use `docker exec -it [CONTAINER] cvedb -u` to update the database.
  - Most importantly, you can use **the WEB INTERFACE at port 5000** (or whatever you exposed)

### withdb flavour, with pre-initialized embedded DB
This flavour will save you a lot of time when booting, as it will run immediately the web server, while starting a DB update as a background task.
This means that the server will be available right now, but the data will be the one of the last snapshot until the update procedure complete.
The background update can take some 2 or 3 minutes to complete while the full DB initialization from scratch takes around 2 or 3 hours.

```sh
sudo docker build -t cve-search:withdb -f ./Dockerfile.withdb .
sudo docker run -d -p 5000:5000 --name cve cve-search:withdb

# The container execute the following commands by itself on boot:
sudo docker exec -it cve /bin/bash
cd /opt/cve/
./sbin/db_updater.py -v
```

## References
- https://github.com/cve-search/cve-search/issues/205
- https://github.com/cve-search/cve-search
- https://hub.docker.com/_/mongo/

This fork is based on the work of (latest updated first):
- https://github.com/digitalshadows/docker-cve-search
- https://github.com/ttimasdf/docker-cve-search
- https://github.com/leojcollard/cve-search-docker
